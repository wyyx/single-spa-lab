(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["workbench"],{"0985":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"workench-page app-relative app-fill-height"},[a("router-view"),a("AccountDrawer",{model:{value:t.showDrawer,callback:function(e){t.showDrawer=e},expression:"showDrawer"}})],1)},r=[],n=a("2b0e"),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"account-drawer-component"},[a("v-navigation-drawer",{staticClass:"app-z-index-50 app-fill-width",style:{transform:t.value?"translateX(-0px)":"translateX(-100%)"},attrs:{fixed:"",temporary:""},model:{value:t.drawer,callback:function(e){t.drawer=e},expression:"drawer"}},[a("MyPage",[a("v-btn",{directives:[{name:"touch",rawName:"v-touch:tap.prevent",value:t.closeDrawer,expression:"closeDrawer",arg:"tap",modifiers:{prevent:!0}}],staticClass:"close-drawer-btn",attrs:{dark:"",icon:""}},[a("v-icon",[t._v("close")])],1)],1)],1)],1)},s=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"my-page app-relative app-fill-height app-bg "},[a("div",{staticClass:"top-wrapper"},[a("div",{staticClass:"primary white--text py-2 app-relative"},[t._t("default"),a("v-layout",{staticClass:"teachers app-relative",attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"pl-3 pt-3 pb-3",attrs:{xs7:""}},[a("v-layout",{attrs:{row:"",nowrap:"","align-center":""}},[a("v-flex",{staticClass:"pl-2 app-relative",attrs:{shrink:""}},[t.currentRole.headImgUrl?a("v-avatar",{staticClass:"fix-avatar",attrs:{tile:!1,size:48,color:"grey lighten-4"}},[a("img",{attrs:{src:t.currentRole.headImgUrl+"?imageView2/0/w/128",alt:"avatar"}})]):a("div",{staticClass:"avatar-wrapper app-both-center"},[a("v-icon",{attrs:{color:"grey lighten-2",size:"56"}},[t._v("\n                  account_circle\n                ")])],1)],1),a("v-flex",{staticClass:"app-v-center pl-2",attrs:{shrink:""}},[t.currentRole.code===t.roleType.Teacher||t.currentRole.code===t.roleType.HeadTeacher?a("div",{staticClass:"app-fill-height"},[a("div",[a("div",{staticClass:"py-1 title"},[t._v(t._s(t.user.name))]),a("div",{staticClass:"py-1 body-2"},[t._v("\n                    "+t._s(t.currentRole.name)+t._s(t.currentRole.isHeadTeacher?" / 班主任":"")+"\n                  ")])])]):t._e(),t.currentRole.code===t.roleType.Student?a("div",{staticClass:"app-fill-height"},[a("div",[a("div",{staticClass:"py-1 title"},[t._v(t._s(t.currentRole.name))]),a("div",{staticClass:"py-1 body-2"},[t._v("\n                    "+t._s(t.currentStudent.className)+"\n                  ")])])]):t._e(),t.currentRole.code===t.roleType.SchoolRun?a("div",{staticClass:"app-fill-height"},[a("div",[a("div",{staticClass:"py-1 title"},[t._v(t._s(t.user.name))]),a("div",{staticClass:"py-1 body-2"},[t._v(t._s(t.currentRole.name))])])]):t._e()])],1)],1),a("v-flex",{staticClass:"py-3 app-v-center",attrs:{xs5:""}},[t.roleList.length>0?a("v-menu",{attrs:{"offset-y":""},scopedSlots:t._u([{key:"activator",fn:function(e){var i=e.on;return[a("v-btn",t._g({staticClass:"ma-0 white",attrs:{round:""}},i),[a("v-icon",[t._v("swap_vert")]),a("span",{staticClass:"body-2"},[t._v("切换")])],1)]}}],null,!1,3345704441)},[a("v-list",[t._l(t.roleList||[],function(e){return a("v-list-tile",{key:e.code+"-"+e.refId,class:{"grey lighten-3":t.currentRole.code+"-"+t.currentRole.refId===e.code+"-"+e.refId,"primary--text":t.currentRole.code+"-"+t.currentRole.refId===e.code+"-"+e.refId},on:{click:function(a){return t.switchRole(e)}}},[a("span",{staticClass:"pr-1"},[t._v(t._s(e.name))]),t.currentRole.code+"-"+t.currentRole.refId===e.code+"-"+e.refId?a("v-icon",{attrs:{color:t.currentRole.code+"-"+t.currentRole.refId===e.code+"-"+e.refId?"primary":"grey lighten-3"}},[t._v("check")]):t._e()],1)}),a("v-list-tile",{on:{click:function(e){return t.goToBindingPage()}}},[a("v-icon",[t._v("add")]),a("span",[t._v("添加")])],1)],2)],1):t._e()],1),a("div",{directives:[{name:"ripple",rawName:"v-ripple"}],staticClass:"edit-profile-btn app-both-center pa-2",on:{click:t.goToUserSettingsPage}},[a("font-awesome-icon",{style:{color:"white"},attrs:{icon:"edit"}})],1)],1)],2),a("v-layout",{staticClass:"text-xs-center py-1 primary lighten-1 body-2",attrs:{row:"",wrap:""}},[a("v-flex",[a("div",{staticClass:"subheading white--text"},[t._v("\n          "+t._s(t.familyInfo.dynamicNumber||0)+"\n        ")]),a("div",{staticClass:"grey--text text--darken-3 caption"},[t._v("动态")])]),a("v-flex",[a("div",{staticClass:"subheading white--text"},[t._v("\n          "+t._s(t.familyInfo.followNumber||0)+"\n        ")]),a("div",{staticClass:"grey--text text--darken-3 caption"},[t._v("关注")])]),a("v-flex",[a("div",{staticClass:"subheading white--text"},[t._v("\n          "+t._s(t.familyInfo.attentionNumber||0)+"\n        ")]),a("div",{staticClass:"grey--text text--darken-3 caption"},[t._v("粉丝")])])],1),t.hasUnfinishedStudentInfoCollection||t.hasUnfinishedTeacherInfoCollection?a("div",{staticClass:"pa-2",attrs:{flat:""}},[t.hasUnfinishedStudentInfoCollection?a("v-btn",{attrs:{round:"",color:"accent"},on:{click:t.goToStudentInfoCollectionPage}},[t._v("建立学生档案")]):t._e(),t.hasUnfinishedTeacherInfoCollection?a("v-btn",{attrs:{round:"",color:"accent"},on:{click:t.goToTeacherInfoCollectionPage}},[t._v("建立老师档案")]):t._e()],1):t._e()],1),a("div",{ref:"scrollWrapper",staticClass:"app-scroll-y app-hidden-x",style:{height:t.scrollHeight+"px"},on:{scroll:t.onScroll}},[a("div",{staticClass:"dynamic-list pa-3"},t._l(t.dynamicList,function(e){return a("div",{key:e.id,staticClass:"dynamic-wrapper"},[t.isDynamic(e)?a("v-card",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{flat:""},on:{click:function(a){return t.goToDynamicDetailPage(e)}}},[a("div",{staticClass:"clickable"},[a("div",{staticClass:"pl-1 pr-1 pt-3"},[a("h3",{staticClass:"subheading mb-0 app-line-height-150"},[t._v("\n                "+t._s(e.context&&e.context.text)+"\n              ")])]),a("v-layout",{staticClass:"pb-1",attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"grey--text app-v-center px-1 caption"},[t._v(t._s(e.userName))]),a("v-flex",{staticClass:"grey--text app-v-center px-1 caption"},[t._v(t._s(e.createTime))]),a("v-flex",{attrs:{shrink:""}},[a("v-btn",{directives:[{name:"touch",rawName:"v-touch:tap.prevent",arg:"tap",modifiers:{prevent:!0}}],staticClass:"ma-0",attrs:{icon:""},on:{click:function(a){a.stopPropagation(),t.currentDynamic=e,t.dialog=!0}}},[a("v-icon",{attrs:{color:"red lighten-1"}},[t._v("delete")])],1)],1)],1)],1),a("v-divider")],1):t._e(),t.isArticle(e)?a("v-card",{directives:[{name:"ripple",rawName:"v-ripple"}],attrs:{flat:""},on:{click:function(a){return t.goToDynamicDetailPage(e)}}},[a("div",{staticClass:"clickable"},[a("div",{staticClass:"pl-1 pr-1 pt-3"},[a("h3",{staticClass:"subheading mb-0 app-line-height-150"},[t._v("\n                "+t._s(e.title)+"\n              ")])]),a("v-layout",{staticClass:"pb-1",attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"grey--text app-v-center px-1 caption"},[t._v(t._s(e.userName))]),a("v-flex",{staticClass:"grey--text app-v-center px-1 caption"},[t._v(t._s(e.createTime))]),a("v-flex",{attrs:{shrink:""}},[a("v-btn",{directives:[{name:"touch",rawName:"v-touch:tap.prevent",arg:"tap",modifiers:{prevent:!0}}],staticClass:"ma-0",attrs:{icon:""},on:{click:function(a){a.stopPropagation(),t.currentDynamic=e,t.dialog=!0}}},[a("v-icon",{attrs:{color:"red lighten-1"}},[t._v("delete")])],1)],1)],1)],1),a("v-divider")],1):t._e()],1)}),0),t._e(),a("v-dialog",{attrs:{persistent:"","max-width":"500"},model:{value:t.dialog,callback:function(e){t.dialog=e},expression:"dialog"}},[a("v-card",[a("v-card-title",{staticClass:"subheading"},[t._v("确定要删除吗？")]),a("v-card-actions",[a("v-layout",{attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"px-2"},[a("v-btn",{attrs:{block:"",flat:""},on:{click:function(e){t.dialog=!1}}},[t._v("取消")])],1),a("v-flex",{staticClass:"px-2"},[a("v-btn",{attrs:{block:"",color:"primary"},on:{click:function(e){t.deleteDynamic(),t.dialog=!1}}},[t._v("\n                确定\n              ")])],1)],1)],1)],1)],1),a("div",{staticClass:"bottom-wrapper"},[t.loadingMore?a("v-layout",{staticClass:"bottom-hint pa-3",attrs:{row:"",wrap:""}},[a("v-flex",{staticClass:"app-h-center"},[a("v-progress-circular",{attrs:{indeterminate:"",color:"accent"}})],1)],1):t._e()],1)],1)])},l=[],d=a("7ffd"),p=a("2ede"),u=a("bf78"),h=a("80b8"),v=a("1d84"),f=a("c651"),g=a("8c37"),m=a("bd51"),y=a("5f7f"),b=a("30fa"),w=20,x=n["a"].extend({name:"my",data:function(){return{roleType:u["b"],familyInfo:{},dynamicList:[],currentDynamic:{},dialog:!1,loadingMore:!1,hasMore:!0,scrollHeight:0}},components:{},computed:Object.assign({},Object(d["b"])(p["b"],{user:p["v"],roleList:p["o"],currentRole:p["f"],currentStudent:p["g"],hasUnfinishedStudentInfoCollection:p["i"],hasUnfinishedTeacherInfoCollection:p["j"]}),Object(d["b"])(y["e"],{showAccountDrawer:y["c"]})),watch:{currentRole:function(t,e){this.dynamicList=[],this.hasMore=!0,this.loadMyDynamicList(),this.loadMyFamilyInfo()},showAccountDrawer:function(t,e){var a=this;t&&(this.dynamicList.length<1||this.familyInfo.id)&&setTimeout(function(){a.loadMyFamilyInfo(),a.loadMyDynamicList()},50)}},created:function(){},mounted:function(){this.setScrollData()},methods:{goToDynamicDetailPage:function(t){var e=localStorage.getItem(m["d"].schoolId);console.log("TCL: dynamic -> schoolId",e),this.$router.push({path:"/dynamic/"+t.id+"/?s="+e})},setScrollData:function(){var t=window.screen.height;console.log("TCL: setScrollData -> screenHeight",t);var e=document.querySelector(".top-wrapper").clientHeight;console.log("TCL: setScrollData -> topWrapperHeight",e),this.scrollHeight=t-e,console.log("TCL: setScrollData -> this.scrollHeight",this.scrollHeight)},deleteDynamic:function(){var t=this;this.currentDynamic.id&&g["a"].deleteDynamicMix(this.currentDynamic.id).then(function(e){e.data.content&&(t.dynamicList=t.dynamicList.filter(function(e){return e.id!==t.currentDynamic.id}))})},isArticle:function(t){return t.type===f["a"].Original||t.type===f["a"].Reprint},isDynamic:function(t){return t.type===f["a"].Dynamic},loadMyDynamicList:function(){var t=this;g["a"].getMyDynamicMixList({pageNo:0,pageSize:w}).then(function(e){console.log("TCL: loadMyDynamicList -> res",e),t.dynamicList=e.data.content||[]})},goToUserSettingsPage:function(){console.log("TCL: goToUserSettingsPage -> goToUserSettingsPage");var t=this,e=t.currentRole;switch(e.code){case u["b"].Student:this.$router.push({name:"user-settings-parents"});break;case u["b"].Teacher:this.$router.push({name:"user-settings-teacher"});break;case u["b"].SchoolRun:this.$router.push({name:"user-settings-school-run"});break;default:break}},goToStudentInfoCollectionPage:function(){this.$router.push({name:"create-archive-for-student"})},goToTeacherInfoCollectionPage:function(){this.$router.push({name:"create-archive-for-teacher"})},goToDynamicHomePage:function(){this.$router.push({name:"dynamic-home-for-user"})},goToBindingPage:function(){this.$router.push({name:"binding"})},loadMyFamilyInfo:function(){var t=this;g["a"].getMyFamilyInfo().then(function(e){console.log("TCL: loadMyFamilyInfo -> res",e),t.familyInfo=e.data.content||{}})},switchRole:function(t){h["a"].store.dispatch(p["b"]+v["d"],t)},onScroll:function(){var t=this.$refs.scrollWrapper;t&&Object(b["a"])(t)&&this.loadMore()},loadMore:function(){var t=this;if(console.log("loadMore"),this.hasMore&&!this.loadingMore){this.showLoadingMore();var e=Math.ceil(this.dynamicList.length/w);console.log("TCL: loadMore -> currentPage",e),g["a"].getMyDynamicMixList({pageNo:e+1,pageSize:w}).then(function(e){var a=e.data.content||[];a.length<1&&(t.hasMore=!1),t.dynamicList=t.dynamicList.concat(a),setTimeout(function(){t.hideLoadingMore()},500)}).catch(function(e){t.hideLoadingMore()})}},showLoadingMore:function(){this.loadingMore=!0},hideLoadingMore:function(){this.loadingMore=!1}}}),C=x,_=(a("f669"),a("0c7c")),S=a("6544"),D=a.n(S),M=a("8212"),k=a("8336"),T=a("b0af"),I=a("99d9"),L=a("12b2"),R=a("169a"),U=a("ce7e"),P=a("0e8f"),N=a("132d"),V=a("a722"),$=a("8860"),A=a("ba95"),O=a("e449"),H=a("490a"),j=a("269a"),B=a.n(j),F=a("3ccf"),z=Object(_["a"])(C,c,l,!1,null,"341b1810",null),W=z.exports;D()(z,{VAvatar:M["a"],VBtn:k["a"],VCard:T["a"],VCardActions:I["a"],VCardTitle:L["a"],VDialog:R["a"],VDivider:U["a"],VFlex:P["a"],VIcon:N["a"],VLayout:V["a"],VList:$["a"],VListTile:A["a"],VMenu:O["a"],VProgressCircular:H["a"]}),B()(z,{Ripple:F["a"]});var E=n["a"].extend({props:{value:{type:Boolean,default:!1}},watch:{value:function(t,e){this.drawer=this.value}},computed:Object.assign({},Object(d["b"])(p["b"],{currentRole:p["f"]})),components:{MyPage:W},data:function(){return{drawer:!1}},methods:{closeDrawer:function(){h["a"].store.set(y["e"]+y["c"],!1),this.goToCurrentWorkbench()},goToCurrentWorkbench:function(){var t=this,e=t.currentRole;switch(e.code){case u["b"].Parents:this.$router.push({name:"parents"});break;case u["b"].Student:this.$router.push({name:"parents"});break;case u["b"].Teacher:this.$router.push({name:"teacher"});break;case u["b"].SchoolRun:this.$router.push({name:"school-run"});break;default:this.$router.push({path:"/"});break}}}}),J=E,X=(a("32c1"),a("f774")),q=Object(_["a"])(J,o,s,!1,null,"ef0cb26c",null),G=q.exports;D()(q,{VBtn:k["a"],VIcon:N["a"],VNavigationDrawer:X["a"]});var K=n["a"].extend({components:{AccountDrawer:G},computed:Object.assign({},Object(d["b"])(y["e"],{showAccountDrawer:y["c"]}),{showDrawer:{get:function(){var t=this;return t.showAccountDrawer},set:function(t){}}}),data:function(){return{}},created:function(){this.$changeTitle("工作台")},methods:{}}),Q=K,Y=Object(_["a"])(Q,i,r,!1,null,"29152bef",null);e["default"]=Y.exports},"30fa":function(t,e,a){"use strict";function i(t){var e=t.scrollHeight-t.offsetHeight;return t.scrollTop===e}a.d(e,"a",function(){return i})},"32c1":function(t,e,a){"use strict";var i=a("d851"),r=a.n(i);r.a},"8c37":function(t,e,a){"use strict";a.d(e,"a",function(){return n});var i=a("cfdf"),r=function(){function t(){this.baseUrl="",this.httpConfigService=i["a"]}var e=t.prototype;return e.addArticle=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/article-insert",t)},e.deleteDynamicMix=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/delete-by-id",{id:t})},e.getArticleHtml=function(t){return this.httpConfigService.httpSercvice.get(this.baseUrl+"/wx/x/crawler/get",{params:{url:t}})},e.getDynamicMixById=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-id",{id:t})},e.getDynamicMixByIdNoAuth=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-id-and-not-filter",{id:t})},e.getMyDynamicMixList=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-page-by-my-family",t)},e.getDynamicMixListByFamilyId=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-page-by-family-id",t)},e.getNextDynamicMix=function(){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-next")},e.getNextDynamicMixNoAuth=function(){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-next")},e.getPrevDynamicMix=function(){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-prev")},e.getPrevDynamicMixNoAuth=function(){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic/select-by-prev")},e.getCommentList=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic-comment/select-page",t)},e.addComment=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic-comment/insert",t)},e.addCommentReply=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic-comment-reply/insert",t)},e.like=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/dynamic-like/save",t)},e.getFamilyInfoById=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/family-follow/get-family",t)},e.getMyFamilyInfo=function(){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/family/get-my-family")},e.getOfficialSiteArticle=function(t){return this.httpConfigService.httpSercvice.post(this.baseUrl+"/wx/content/select-by-id",{id:t})},t}(),n=new r},a122:function(t,e,a){e=t.exports=a("24fb")(!1),e.push([t.i,".my-page[data-v-341b1810]{overflow:hidden;display:flex;flex-direction:column}.teachers[data-v-341b1810]{position:relative}.scores[data-v-341b1810]{text-align:center}.check-in-btn[data-v-341b1810]{position:absolute;right:0;bottom:15px;margin:0;border-top-left-radius:100px;border-top-right-radius:0;border-bottom-right-radius:0;border-bottom-left-radius:100px}.v-btn[data-v-341b1810]{min-width:unset!important}.edit-profile-btn[data-v-341b1810]{position:absolute;right:10px;bottom:4px;border-radius:100px}.avatar-wrapper[data-v-341b1810]{width:48px;height:48px;overflow:hidden;border-radius:100px}.scroll-com[data-v-341b1810]{overflow:hidden}.bottom-wrapper[data-v-341b1810]{position:absolute;width:100%;bottom:0}.dynamic-list[data-v-341b1810]{padding-bottom:200px}",""])},a616:function(t,e,a){e=t.exports=a("24fb")(!1),e.push([t.i,".close-drawer-btn[data-v-ef0cb26c]{position:absolute;right:0;top:0;z-index:60}.v-navigation-drawer[data-v-ef0cb26c]{background-color:#f7f7f7}",""])},c651:function(t,e,a){"use strict";var i;a.d(e,"a",function(){return i}),function(t){t[t["Original"]=1]="Original",t[t["Reprint"]=2]="Reprint",t[t["Dynamic"]=3]="Dynamic"}(i||(i={}))},d851:function(t,e,a){var i=a("a616");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("499e").default;r("43b89a91",i,!0,{sourceMap:!1,shadowMode:!1})},f669:function(t,e,a){"use strict";var i=a("fd0f"),r=a.n(i);r.a},fd0f:function(t,e,a){var i=a("a122");"string"===typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);var r=a("499e").default;r("322e9500",i,!0,{sourceMap:!1,shadowMode:!1})}}]);